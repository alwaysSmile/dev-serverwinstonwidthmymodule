//************
var url = require('url');
var log = require('./log')(module);//log.js принимает текущий объект модуля
//и возвращает тот же winston, но по разному настроенный
//log.js - это переменное окружение, нами написанное

module.exports = function (req, res) {
    var urlParsed = url.parse(req.url, true);

    log.info("Got request", req.method, req.url);

    if (req.method == 'GET' && urlParsed.pathname == '/echo' && urlParsed.query.message) {
        var message = urlParsed.query.message;
        log.debug("Echo: " + message);
        res.end(message);
        return;
    }

    log.error("Unknown URL");

    res.statusCode = 404;
    res.end('Page no found')
};
//************

